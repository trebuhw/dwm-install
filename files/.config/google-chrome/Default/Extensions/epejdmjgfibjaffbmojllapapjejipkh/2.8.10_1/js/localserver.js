function getServerTimeStampValue(){const tM=new TimeManager,SERVER_TIMESTAMP=storageLocalApi.getItem(BOOKMARK_SERVER_TIME)||tM.getCurrentTime();return 0==SERVER_TIMESTAMP?tM.getCurrentTime():SERVER_TIMESTAMP}function fetchUserInfo(){if(SamsungSCloudSyncService.ACCOUNT_NAME=storageLocalApi.getItem(ACCOUNT_NAME),null==SamsungSCloudSyncService.DEVICE_NAME){const{BROWSER_NAME:BROWSER_NAME="PC_Browser",EXT_VERSION:EXT_VERSION,PLATFORM_NAME:PLATFORM_NAME}=SamsungSCloudSyncService;var accidx=SamsungSCloudSyncService.ACCOUNT_NAME.indexOf("@"),accountName=SamsungSCloudSyncService.ACCOUNT_NAME;accidx>0&&(accountName=SamsungSCloudSyncService.ACCOUNT_NAME.substr(0,accidx)),SamsungSCloudSyncService.DEVICE_NAME=`${accountName}_${EXT_VERSION}_${BROWSER_NAME}_${PLATFORM_NAME}`}SamsungSCloudSyncService.BrowserOverlay.launchSyncPage()}SamsungSCloudSyncService.BROWSER_NAME=getBrowserName(),SamsungSCloudSyncService.PLATFORM_NAME=navigator.platform,SamsungSCloudSyncService.NEW_TAB_URL_ID=null,SamsungSCloudSyncService.EXT_ID=chrome.i18n.getMessage("@@extension_id"),SamsungSCloudSyncService.EXT_VERSION=chrome.runtime.getManifest().version,SamsungSCloudSyncService.NEW_TAB_URL="chrome://newtab/",SamsungSCloudSyncService.LAUNCH_URL="chrome-extension://"+SamsungSCloudSyncService.EXT_ID+"/login-load.html",SamsungSCloudSyncService.DEVICE_NAME=null,SamsungSCloudSyncService.ACCOUNT_NAME=null,SamsungSCloudSyncService.ACCOUNT_TYPE="com.osp.app.signin",SamsungSCloudSyncService.tokenV=null,SamsungSCloudSyncService.isSyncTabLaunched=!1,SamsungSCloudSyncService.isLoginTabLaunched=!1,SamsungSCloudSyncService.firstSynced=!1,SamsungSCloudSyncService.isAccessToken=!1,SamsungSCloudSyncService.SYNC_TIMER=-1,SamsungSCloudSyncService.AUTO_SYNC_TIMER=-1,SamsungSCloudSyncService.SYNC_TIMER_VAL=18e5,SamsungSCloudSyncService.AUTO_SYNC_TIMER_VAL=18e5,SamsungSCloudSyncService.INTERNET_FAILURE_TEXT="Internet Connectivity Failure; Check your Internet Connection",SamsungSCloudSyncService.updateTabOperations=[],SamsungSCloudSyncService.insertDeletedTabOperations=[],SamsungSCloudSyncService.isTabSyncStatus=!1,SamsungSCloudSyncService.OLD_SYNC_KEY="00:24:54:98:C2:B0",SamsungSCloudSyncService.NEW_SYNC_KEY="00245498C2B0",SamsungSCloudSyncService.sAuthManager=null,SamsungSCloudSyncService.mCloudServiceManager=null,SamsungSCloudSyncService.mKVSConstants=null,SamsungSCloudSyncService.mSyncConstants=null,SamsungSCloudSyncService.mORSConstants=null,SamsungSCloudSyncService.mServerCommonConstants=null,SamsungSCloudSyncService.recordServiceManager=null,SamsungSCloudSyncService.mNetClient=null,SamsungSCloudSyncService.mNetworkResponse=null,SamsungSCloudSyncService.mKVSResponse=null,SamsungSCloudSyncService.mBrowserConstants=null,SamsungSCloudSyncService.mContentProvider=null,SamsungSCloudSyncService.mICloudServiceManager=null,SamsungSCloudSyncService.mAppTool=null,SamsungSCloudSyncService.mClientDeviceId=null,SamsungSCloudSyncService.mBrowserBookmarkSyncAdapter=null,SamsungSCloudSyncService.mBrowserTabSyncAdapter=null,SamsungSCloudSyncService.syncTabsInDB=!1,SamsungSCloudSyncService.firstSyncCompleted=!1,SamsungSCloudSyncService.mSyncCancelled=!1,storageLocalApi.setArrayItems([["EXT_ID",SamsungSCloudSyncService.EXT_ID],["ACCOUNT_TYPE",SamsungSCloudSyncService.ACCOUNT_TYPE]]),storageLocalApi.waitForAvailable().then((()=>{SamsungSCloudSyncService.CURRENT_DATE_TIME=storageLocalApi.getItem("CURRENT_DATE_TIME")||Date.now().toString(36),SamsungSCloudSyncService.DEVICE_ID=`${SamsungSCloudSyncService.EXT_ID}_${SamsungSCloudSyncService.EXT_VERSION}_${SamsungSCloudSyncService.BROWSER_NAME}_Desktop_${SamsungSCloudSyncService.PLATFORM_NAME}_${SamsungSCloudSyncService.CURRENT_DATE_TIME}`,storageLocalApi.setItem("CURRENT_DATE_TIME",SamsungSCloudSyncService.CURRENT_DATE_TIME),storageLocalApi.setArrayItems([["DEVICE_ID",SamsungSCloudSyncService.DEVICE_ID],["CURRENT_DATE_TIME",SamsungSCloudSyncService.CURRENT_DATE_TIME]])})),SamsungSCloudSyncService.BrowserOverlay={clearAutoSyncTimeoutInterval(flag){SamsungSCloudSyncService.SyncLogs.log(`Auto Sync Timer Cleared = ${SamsungSCloudSyncService.AUTO_SYNC_TIMER}`),SamsungSCloudSyncService.AUTO_SYNC_TIMER>0&&(clearInterval(SamsungSCloudSyncService.AUTO_SYNC_TIMER),SamsungSCloudSyncService.AUTO_SYNC_TIMER=-1),flag||(SamsungSCloudSyncService.BrowserOverlay.applyAutoSyncTimeoutInterval(),SamsungSCloudSyncService.SyncLogs.log("Auto Sync Timer Applied"))},applyAutoSyncTimeoutInterval(){-1==SamsungSCloudSyncService.AUTO_SYNC_TIMER?(SamsungSCloudSyncService.AUTO_SYNC_TIMER=setInterval((()=>{SamsungSCloudSyncService.SyncLogs.log("Auto Syncing..."),SamsungSCloudSyncService.BrowserOverlay.refreshSyncProcess()}),SamsungSCloudSyncService.AUTO_SYNC_TIMER_VAL),SamsungSCloudSyncService.SyncLogs.log(`Auto Sync Timer applied = ${SamsungSCloudSyncService.AUTO_SYNC_TIMER}`)):SamsungSCloudSyncService.SyncLogs.log(`Auto Sync Timer Value = ${SamsungSCloudSyncService.AUTO_SYNC_TIMER}`)},clearSyncTimeoutInterval(){SamsungSCloudSyncService.SyncLogs.log(`Sync Timer Cleared = ${SamsungSCloudSyncService.SYNC_TIMER}`),SamsungSCloudSyncService.SYNC_TIMER>0&&(clearInterval(SamsungSCloudSyncService.SYNC_TIMER),SamsungSCloudSyncService.SYNC_TIMER=-1)},applySyncTimeoutInterval(){-1==SamsungSCloudSyncService.SYNC_TIMER?(SamsungSCloudSyncService.SYNC_TIMER=setInterval(SamsungSCloudSyncService.BrowserOverlay.showSyncErrorMsg,SamsungSCloudSyncService.SYNC_TIMER_VAL),SamsungSCloudSyncService.SyncLogs.log("Sync Timer Applied = "+SamsungSCloudSyncService.SYNC_TIMER)):SamsungSCloudSyncService.SyncLogs.log(`Timer Value = ${SamsungSCloudSyncService.SYNC_TIMER}`)},showSyncErrorMsg(){SamsungSCloudSyncService.BrowserOverlay.clearSyncTimeoutInterval(),SamsungSCloudSyncService.BrowserOverlay.clearAutoSyncTimeoutInterval(!1),chrome.runtime.sendMessage({ERROR:"Sync Timeout"}),SamsungSCloudSyncService.BrowserOverlay.onLogoutClick(),chrome.action.setPopup({popup:""}),chrome.action.setIcon({path:"assets/img/logo32x32_gray.png"})},async onAccessTokenReceived(url,tokens){SamsungSCloudSyncService.mSyncCancelled=!1;const{BROWSER_NAME:BROWSER_NAME="PC_Browser",EXT_VERSION:EXT_VERSION,PLATFORM_NAME:PLATFORM_NAME}=SamsungSCloudSyncService,params={};if(url.replace(/[?&]+([^=&]+)=([^&]*)/gi,((str,key,value)=>params[key]=value)),params.inputUserID){SamsungSCloudSyncService.ACCOUNT_NAME=params.inputUserID,SamsungSCloudSyncService.ACCOUNT_NAME.replace("%40","@");var idx=SamsungSCloudSyncService.ACCOUNT_NAME.indexOf("@"),accName=SamsungSCloudSyncService.ACCOUNT_NAME.substr(0,idx);SamsungSCloudSyncService.DEVICE_NAME=`${accName}_${EXT_VERSION}_${BROWSER_NAME}_${PLATFORM_NAME}`}if(params.inputEmailID){SamsungSCloudSyncService.ACCOUNT_NAME=params.inputEmailID,(idx=SamsungSCloudSyncService.ACCOUNT_NAME.indexOf("%40"))>0&&(SamsungSCloudSyncService.ACCOUNT_NAME=SamsungSCloudSyncService.ACCOUNT_NAME.replace("%40","@"));idx=SamsungSCloudSyncService.ACCOUNT_NAME.indexOf("@"),accName=SamsungSCloudSyncService.ACCOUNT_NAME.substr(0,idx);SamsungSCloudSyncService.DEVICE_NAME=`${accName}_${EXT_VERSION}_${BROWSER_NAME}_${PLATFORM_NAME}`}params.inputPhoneID&&(SamsungSCloudSyncService.ACCOUNT_NAME=params.inputPhoneID,SamsungSCloudSyncService.DEVICE_NAME=`${params.inputPhoneID}_${EXT_VERSION}_${BROWSER_NAME}_${PLATFORM_NAME}`),params.client_id&&(SamsungSCloudSyncService.CLIENT_ID=params.client_id),tokens.userId&&(SamsungSCloudSyncService.USER_ID=tokens.userId),tokens.access_token&&(SamsungSCloudSyncService.tokenV=tokens.access_token,SamsungSCloudSyncService.isAccessToken=!0),await storageLocalApi.setArrayItems([[ACCOUNT_NAME,SamsungSCloudSyncService.ACCOUNT_NAME],[CLIENT_ID,SamsungSCloudSyncService.CLIENT_ID],[USER_ID,SamsungSCloudSyncService.USER_ID],[ACCESS_TOKEN,SamsungSCloudSyncService.tokenV]]),SamsungSCloudSyncService.isAccessToken&&(SamsungSCloudSyncService.sAuthManager=SamsungSCloudSyncService.sAuthManager||new AuthManager,SamsungSCloudSyncService.sAuthManager.setAccessToken(SamsungSCloudSyncService.tokenV))},onBrowserActionClicked(){SamsungSCloudSyncService.tokenV=storageLocalApi.getItem(ACCESS_TOKEN),SamsungSCloudSyncService.tokenV?fetchUserInfo():SamsungSCloudSyncService.BrowserOverlay.launchLoginPage()},launchSyncPage(){SamsungSCloudSyncService.SyncLogs.log("launchSyncPage"),chrome.runtime.sendMessage({USER_LOGGED_IN:!0}),SamsungSCloudSyncService.mContentProvider=SamsungSCloudSyncService.mContentProvider||new ContentProvider,SamsungSCloudSyncService.BrowserOverlay.startSync()},syncOpenedTabs:function(){SamsungSCloudSyncService.firstSynced=!0,SamsungSCloudSyncService.mContentProvider||(SamsungSCloudSyncService.mContentProvider=new ContentProvider),DB.Query.tabs({selection:["*"],where:{equals:[{key:"DEVICE_ID",value:SamsungSCloudSyncService.DEVICE_ID}]}}).then((results=>{chrome.windows.getAll({populate:!0},(function(windows){for(var tabDB=new Array(results.length),k=0;k<results.length;k++)tabDB[k]=results[k].TAB_ID;for(var i=0;i<windows.length;i++)for(var openedTabID=new Array(windows[i].tabs.length),j=0;j<windows[i].tabs.length;j++)openedTabID[j]=windows[i].tabs[j].id,(0==results.length||tabDB.indexOf(windows[i].tabs[j].id)>=0)&&SamsungSCloudSyncService.BrowserOverlay.syncOpenTabData(windows[i].tabs[j]);for(k=0;k<results.length;k++)if(-1==openedTabID.indexOf(tabDB[k])){var tabs={DIRTY:1,IS_DELETED:"1",SYNC5:0};SamsungSCloudSyncService.mContentProvider.Update("TABS",tabs,{equals:[{key:"DEVICE_ID",value:SamsungSCloudSyncService.DEVICE_ID}]},null,null)}SamsungSCloudSyncService.updateTabOperations.length>0?SamsungSCloudSyncService.mContentProvider.applyBatch(SamsungSCloudSyncService.updateTabOperations,SamsungSCloudSyncService.BrowserOverlay.updateTabOperationsCallback):SamsungSCloudSyncService.BrowserOverlay.updateTabOperationsCallback()}))}))},syncOpenTabData:function(tab){var tabData={TAB_ID:tab.id,TAB_ACTIVATE:tab.active,TAB_INDEX:tab.index,TAB_URL:tab.url,TAB_TITLE:tab.title,IS_INCOGNITO:tab.incognito,DEVICE_NAME:EXT_DEVICE_NAME,DEVICE_ID:SamsungSCloudSyncService.DEVICE_ID,ACCOUNT_NAME:SamsungSCloudSyncService.ACCOUNT_NAME,ACCOUNT_TYPE:SamsungSCloudSyncService.ACCOUNT_TYPE,IS_DELETED:"0",SYNC5:0};SamsungSCloudSyncService.updateTabOperations.push(new BatchOperation("UPDATE","TABS",tabData,{equals:[{key:"TAB_ID",value:tab.id},{key:"DEVICE_ID",value:SamsungSCloudSyncService.DEVICE_ID}]}))},updateTabOperationsCallback:function(result=[],data){SamsungSCloudSyncService.SyncLogs.log("updateTabOperations callback called"),SamsungSCloudSyncService.updateTabOperations=[];for(var i=0;i<result.length;i++)0==result[i].rowsAffected&&(data[i].DIRTY=1,0!=data[i].TAB_URL.indexOf("browser")&&0!=data[i].TAB_URL.indexOf("chrome")&&0!=data[i].TAB_URL.indexOf("opera")&&0!=data[i].TAB_URL.indexOf("file")&&0!=data[i].TAB_URL.indexOf("content")&&0!=data[i].TAB_URL.indexOf("view")&&0!=data[i].TAB_URL.indexOf("data")||(data[i].DIRTY=0),SamsungSCloudSyncService.insertDeletedTabOperations.push(new BatchOperation("INSERT","TABS",data[i],null)));SamsungSCloudSyncService.insertDeletedTabOperations.length>0?SamsungSCloudSyncService.mContentProvider.applyBatch(SamsungSCloudSyncService.insertDeletedTabOperations,SamsungSCloudSyncService.BrowserOverlay.insertDeletedTabOperationsCallback):SamsungSCloudSyncService.BrowserOverlay.insertDeletedTabOperationsCallback()},insertDeletedTabOperationsCallback:function(){SamsungSCloudSyncService.SyncLogs.log("insertDeletedTabOperationsCallback called"),SamsungSCloudSyncService.insertDeletedTabOperations=[],SamsungSCloudSyncService.currentSync},refreshSyncProcess(){if(storageLocalApi.getItem(SYNC_STATUS)!==SYNC_COMPLETED)return void SamsungSCloudSyncService.SyncLogs.log("Sync is in progress");if(!isBookmarkSyncOn()&&!isOpenTabsSyncOn())return void SamsungSCloudSyncService.SyncLogs.log("Samsung Internet Sync is disabled");const startProcess=async()=>{await storageLocalApi.setItem(SYNC_STATUS,SYNC_STARTED),SamsungSCloudSyncService.mSyncCancelled=!1,SamsungSCloudSyncService.BrowserOverlay.onBrowserActionClicked()},pushExpireTime=storageLocalApi.getItem(PUSH_EXPIRE_TIME);pushExpireTime&&pushExpireTime<Date.now()?(SamsungSCloudSyncService.SyncLogs.log(`Re-Activating token as push_expire_time is old [${new Date(Number(pushExpireTime))}] < [${new Date}]`),updateAccessToken(storageLocalApi.getItem(ACCESS_TOKEN),!1).then(startProcess).catch((err=>{SamsungSCloudSyncService.SyncLogs.log("Failed to re-activate in event of push_expire_time > Date.now()"),SamsungSCloudSyncService.SyncLogs.log(err)}))):startProcess()},onLogoutClick(){SamsungSCloudSyncService.firstSyncCompleted=!1,isLoggedIn()||(SamsungSCloudSyncService.mSyncConstants=null,SamsungSCloudSyncService.isAccessToken=!1,SamsungSCloudSyncService.tokenV=null),SamsungSCloudSyncService.BrowserOverlay.onCancelSyncClick()},async onCancelSyncClick(){await storageLocalApi.setItem(SYNC_STATUS,SYNC_COMPLETED),SamsungSCloudSyncService.mSyncCancelled=!0,SamsungSCloudSyncService.mBrowserBookmarkSyncAdapter&&SamsungSCloudSyncService.mBrowserBookmarkSyncAdapter.cancelSync(),SamsungSCloudSyncService.mBrowserTabSyncAdapter&&SamsungSCloudSyncService.mBrowserTabSyncAdapter.cancelSync(),clearLocalStorage(),clearDatabase()},launchLoginPage(){SamsungSCloudSyncService.SyncLogs.log("Trying to refresh token"),refreshAccessToken(storageLocalApi.getItem(REFRESH_TOKEN)).then((({token:token,refreshToken:refreshToken,tokenExpiresIn:tokenExpiresIn,refreshTokenExpiresIn:refreshTokenExpiresIn})=>updateAccessToken(token).then((async()=>{SamsungSCloudSyncService.SyncLogs.log("Refreshed successfully"),storeAccessToken(token),await storageLocalApi.setArrayItems([[REFRESH_TOKEN,refreshToken],[REFRESH_TOKEN_EXPIRES_IN,refreshTokenExpiresIn]]),SamsungSCloudSyncService.BrowserOverlay.refreshSyncProcess()})))).catch((err=>{SamsungSCloudSyncService.SyncLogs.log("Problem in refreshing token"),SamsungSCloudSyncService.SyncLogs.log(err),console.error(err),cleanupStateOnLogout(),chrome.runtime.sendMessage({ACCESS_TOKEN_URL_PROBLEM:"SESSION_EXPIRED"})}))},async startSync(){SamsungSCloudSyncService.mSyncCancelled||(SamsungSCloudSyncService.BrowserOverlay.resetGlobalClassObjects(),SamsungSCloudSyncService.mBrowserConstants=SamsungSCloudSyncService.mBrowserConstants||new BrowserConstants,SamsungSCloudSyncService.mSyncConstants=SamsungSCloudSyncService.mSyncConstants||new SyncConstants,SamsungSCloudSyncService.mContentProvider=SamsungSCloudSyncService.mContentProvider||new ContentProvider,SamsungSCloudSyncService.mKVSConstants=SamsungSCloudSyncService.mKVSConstants||new KVSConstants,SamsungSCloudSyncService.currentSync&&"BOOKMARK_SYNC"!=SamsungSCloudSyncService.currentSync&&isOpenTabsSyncOn()?(SamsungSCloudSyncService.SyncLogs.log("Tab Sync Started"),await storageLocalApi.setItem(SYNC_STATUS,SYNC_STARTED),SamsungSCloudSyncService.currentSync="TAB_SYNC",chrome.runtime.sendMessage({SYNC:SYNC_STARTED}),SamsungSCloudSyncService.isFixParentIDsDone=!1,SamsungSCloudSyncService.BrowserOverlay.applySyncTimeoutInterval(),SamsungSCloudSyncService.mBrowserTabSyncAdapter=new BrowserTabSyncAdapter,SamsungSCloudSyncService.mBrowserTabSyncAdapter.performSync(SamsungSCloudSyncService.mKVSConstants.SYNC_SELF),SamsungSCloudSyncService.BrowserOverlay.syncOpenedTabs()):isBookmarkSyncOn()&&(SamsungSCloudSyncService.SyncLogs.log("Bookmark Sync Started"),await storageLocalApi.setItem(SYNC_STATUS,SYNC_STARTED),SamsungSCloudSyncService.currentSync="ALL_SYNC",chrome.runtime.sendMessage({SYNC:SYNC_STARTED}),SamsungSCloudSyncService.isFixParentIDsDone=!1,SamsungSCloudSyncService.BrowserOverlay.applySyncTimeoutInterval(),SamsungSCloudSyncService.mBrowserBookmarkSyncAdapter=new BrowserBookmarkSyncAdapter,SamsungSCloudSyncService.mBrowserBookmarkSyncAdapter.performSync(SamsungSCloudSyncService.mKVSConstants.SYNC_SELF)))},resetGlobalClassObjects(){SamsungSCloudSyncService.startKey=null,SamsungSCloudSyncService.mCloudServiceManager=null,SamsungSCloudSyncService.mORSConstants=null,SamsungSCloudSyncService.recordServiceManager=null,SamsungSCloudSyncService.mNetClient=null,SamsungSCloudSyncService.mNetworkResponse=null,SamsungSCloudSyncService.mKVSResponse=null,SamsungSCloudSyncService.mICloudServiceManager=null,SamsungSCloudSyncService.mAppTool=null,SamsungSCloudSyncService.mClientDeviceId=null},updateCallback:function(result,tabData){result&&0==result.rowsAffected&&SamsungSCloudSyncService.mContentProvider.Insert("TABS",tabData)},clearTab:function(id){if(void 0!==id){var tabs={DIRTY:1,IS_DELETED:"1",SYNC5:0};SamsungSCloudSyncService.mContentProvider||(SamsungSCloudSyncService.mContentProvider=new ContentProvider),SamsungSCloudSyncService.mContentProvider.Update("TABS",tabs,{equals:[{key:"TAB_ID",value:id}],equals:[{key:"DEVICE_ID",value:SamsungSCloudSyncService.DEVICE_ID}]})}},onLoad(){SamsungSCloudSyncService.tokenV=storageLocalApi.getItem(ACCESS_TOKEN),SamsungSCloudSyncService.tokenV&&(SamsungSCloudSyncService.BrowserOverlay.clearAutoSyncTimeoutInterval(!1),fetchUserInfo()),SamsungSCloudSyncService.BrowserOverlay.resetSyncKey()},resetSyncKey(){SamsungSCloudSyncService.mContentProvider=SamsungSCloudSyncService.mContentProvider||mContentProvider||new ContentProvider,SamsungSCloudSyncService.mContentProvider.Query("BOOKMARKS",["_ID","SYNC1"],null,[],null,SamsungSCloudSyncService.BrowserOverlay.resetBookmarkSyncKey),SamsungSCloudSyncService.mContentProvider.Query("TABS",["_ID","SYNC1"],null,[],null,SamsungSCloudSyncService.BrowserOverlay.resetTabSyncKey)},resetTabSyncKey(result){if(result){SamsungSCloudSyncService.updateTabSyncKeyOperations=[];const updatedTime=Date.now();for(let i=0;i<result.length;i++){const row=result[i];if(null!=row.SYNC1&&void 0!==row.SYNC1&&row.SYNC1.match(SamsungSCloudSyncService.OLD_SYNC_KEY)){const tabData={SYNC1:EXT_DEVICE_ID,DIRTY:1,SYNC5:updatedTime};SamsungSCloudSyncService.updateTabSyncKeyOperations.push(new BatchOperation("UPDATE","TABS",tabData,{equals:[{key:"_ID",value:row._ID}]}))}}SamsungSCloudSyncService.updateTabSyncKeyOperations.length>0&&SamsungSCloudSyncService.mContentProvider.applyBatch(SamsungSCloudSyncService.updateTabSyncKeyOperations,SamsungSCloudSyncService.BrowserOverlay.updateTabSyncKeyOperationsCallback)}},updateTabSyncKeyOperationsCallback(){SamsungSCloudSyncService.updateTabSyncKeyOperations=[]},resetBookmarkSyncKey(result){if(result){SamsungSCloudSyncService.updateBookmarkSyncKeyOperations=[];const updatedTime=Date.now();for(let i=0;i<result.length;i++){const row=result[i];if(null!=row.SYNC1&&void 0!==row.SYNC1&&row.SYNC1.match(SamsungSCloudSyncService.OLD_SYNC_KEY)){const bookmarkData={SYNC1:EXT_DEVICE_ID,DIRTY:1,SYNC5:updatedTime};SamsungSCloudSyncService.updateBookmarkSyncKeyOperations.push(new BatchOperation("UPDATE","BOOKMARKS",bookmarkData,{equals:[{key:"_ID",value:row._ID}]}))}}SamsungSCloudSyncService.updateBookmarkSyncKeyOperations.length>0&&SamsungSCloudSyncService.mContentProvider.applyBatch(SamsungSCloudSyncService.updateBookmarkSyncKeyOperations,SamsungSCloudSyncService.BrowserOverlay.updateBookmarkSyncKeyOperationsCallback)}},updateBookmarkSyncKeyOperationsCallback(){SamsungSCloudSyncService.updateBookmarkSyncKeyOperations=[]},randomUUID(){const quad=()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1).toUpperCase();return`${quad()}${quad()}-${quad()}-${quad()}-${quad()}-${quad()}${quad()}${quad()}`},async onAccessTokenExpire(){SamsungSCloudSyncService.mContentProvider=SamsungSCloudSyncService.mContentProvider||new ContentProvider,SamsungSCloudSyncService.firstSynced=!1,SamsungSCloudSyncService.mSyncConstants=null,SamsungSCloudSyncService.isAccessToken=!1,SamsungSCloudSyncService.tokenV=null,await storageLocalApi.setArrayItems([[BOOKMARK_SERVER_TIME,0],[TAB_SERVER_TIME,0],[IS_LOGGED_OUT,0],[DEVICE_NAME,""],[ACCESS_TOKEN,""],[SYNC_STATUS,""]]),SamsungSCloudSyncService.mContentProvider.Delete("TABS","DEVICE_ID NOT LIKE %Desktop% AND DEVICE_NAME != "+SamsungSCloudSyncService.DEVICE_NAME,null,null);SamsungSCloudSyncService.mContentProvider.Update("TABS",{DIRTY:1,IS_DELETED:"1",SYNC5:0},"DEVICE_NAME = "+SamsungSCloudSyncService.DEVICE_NAME,null,SamsungSCloudSyncService.BrowserOverlay.deleteTabsCallback)},deleteTabsCallback:function(){SamsungSCloudSyncService.mContentProvider.Delete("BOOKMARKS","DEVICE_ID NOT LIKE %Desktop% AND DEVICE_NAME != "+SamsungSCloudSyncService.DEVICE_NAME,null,null);var curTime=Date.now(),bookmarks={DIRTY:1,IS_DELETED:"1",MODIFIED:curTime,SYNC5:curTime};SamsungSCloudSyncService.mContentProvider.Update("BOOKMARKS",bookmarks,"DEVICE_NAME = "+SamsungSCloudSyncService.DEVICE_NAME,null,SamsungSCloudSyncService.BrowserOverlay.deleteBookmarksCallback)},deleteBookmarksCallback:async function(){await storageLocalApi.setItem("isLoggedOut",0),chrome.runtime.sendMessage({ACCESS_TOKEN_URL_PROBLEM:"SESSION_EXPIRED"}),SamsungSCloudSyncService.isSyncTabLaunched=!1,SamsungSCloudSyncService.isLoginTabLaunched=!0,SamsungSCloudSyncService.browserActionClicked=!1,SamsungSCloudSyncService.BrowserOverlay.clearAutoSyncTimeoutInterval(!0)}},chrome.runtime.onStartup.addListener((async()=>{await storageLocalApi.waitForAvailable(),storageLocalApi.getItem(SYNC_STATUS)===SYNC_STARTED&&await storageLocalApi.setItem(SYNC_STATUS,SYNC_COMPLETED),SamsungSCloudSyncService.BrowserOverlay.onLoad()})),chrome.tabs.onCreated.addListener((function(tab){if(tab.url!=SamsungSCloudSyncService.LAUNCH_URL&&tab.url!=SamsungSCloudSyncService.NEW_TAB_URL||(SamsungSCloudSyncService.NEW_TAB_URL_ID=tab.id),null!=SamsungSCloudSyncService.DEVICE_NAME){var tabData={TAB_ID:tab.id,TAB_ACTIVATE:tab.active,TAB_INDEX:tab.index,TAB_URL:tab.url,TAB_TITLE:tab.title,IS_INCOGNITO:tab.incognito,DEVICE_NAME:EXT_DEVICE_NAME,DEVICE_ID:SamsungSCloudSyncService.DEVICE_ID,ACCOUNT_NAME:SamsungSCloudSyncService.ACCOUNT_NAME,ACCOUNT_TYPE:SamsungSCloudSyncService.ACCOUNT_TYPE,DIRTY:1,IS_DELETED:"0",SYNC5:0,DATE_CREATED:AbstractSyncAdapterGlobal.mTimeManager.getCurrentTime(),DATE_MODIFIED:AbstractSyncAdapterGlobal.mTimeManager.getCurrentTime()};0!=tab.url.indexOf("browser")&&0!=tab.url.indexOf("chrome")&&0!=tab.url.indexOf("opera")&&0!=tab.url.indexOf("file")&&0!=tab.url.indexOf("view")&&0!=tab.url.indexOf("content")&&0!=tab.url.indexOf("data")||(tabData.DIRTY=0),SamsungSCloudSyncService.mContentProvider||(SamsungSCloudSyncService.mContentProvider=new ContentProvider),SamsungSCloudSyncService.mContentProvider.Insert("TABS",tabData,null)}})),chrome.tabs.onUpdated.addListener((function(tabId,info,tab){if("complete"==info.status&&(tab.id==SamsungSCloudSyncService.NEW_TAB_URL_ID&&(tab.url!=SamsungSCloudSyncService.NEW_TAB_URL&&tab.url!=SamsungSCloudSyncService.LAUNCH_URL&&null!=SamsungSCloudSyncService.DEVICE_NAME?(SamsungSCloudSyncService.isSyncTabLaunched=!1,SamsungSCloudSyncService.NEW_TAB_URL_ID=null):null!=storageLocalApi.getItem(ACCESS_TOKEN)&&(tab.url!=SamsungSCloudSyncService.NEW_TAB_URL&&tab.url!=SamsungSCloudSyncService.LAUNCH_URL&&(SamsungSCloudSyncService.NEW_TAB_URL_ID=null),SamsungSCloudSyncService.isSyncTabLaunched=!0,SamsungSCloudSyncService.isLoginTabLaunched=!1,SamsungSCloudSyncService.firstSynced||setTimeout("SamsungSCloudSyncService.BrowserOverlay.syncOpenedTabs()",1e3))),SamsungSCloudSyncService.firstSynced)){var tabData={TAB_ID:tab.id,TAB_ACTIVATE:tab.active,TAB_INDEX:tab.index,TAB_URL:tab.url,TAB_TITLE:tab.title,IS_INCOGNITO:tab.incognito,DEVICE_NAME:EXT_DEVICE_NAME,DEVICE_ID:SamsungSCloudSyncService.DEVICE_ID,ACCOUNT_NAME:SamsungSCloudSyncService.ACCOUNT_NAME,ACCOUNT_TYPE:SamsungSCloudSyncService.ACCOUNT_TYPE,DIRTY:1,IS_DELETED:"0",SYNC5:0,DATE_MODIFIED:AbstractSyncAdapterGlobal.mTimeManager.getCurrentTime()};0!=tab.url.indexOf("browser")&&0!=tab.url.indexOf("chrome")&&0!=tab.url.indexOf("opera")&&0!=tab.url.indexOf("file")&&0!=tab.url.indexOf("view")&&0!=tab.url.indexOf("content")&&0!=tab.url.indexOf("data")||(tabData.DIRTY=0),SamsungSCloudSyncService.mContentProvider||(SamsungSCloudSyncService.mContentProvider=new ContentProvider),SamsungSCloudSyncService.mContentProvider.Update("TABS",tabData,{equals:[{key:"TAB_ID",value:tab.id},{key:"DEVICE_ID",value:SamsungSCloudSyncService.DEVICE_ID}]},null,SamsungSCloudSyncService.BrowserOverlay.updateCallback)}})),chrome.tabs.onRemoved.addListener((function(tab){tab==SamsungSCloudSyncService.NEW_TAB_URL_ID?(SamsungSCloudSyncService.NEW_TAB_URL_ID=null,SamsungSCloudSyncService.isSyncTabLaunched=!1,SamsungSCloudSyncService.isLoginTabLaunched=!1):SamsungSCloudSyncService.firstSyncCompleted&&SamsungSCloudSyncService.BrowserOverlay.clearTab(tab)}));