function BookMarkBuilder(provider,account,context){this.mProvider=provider,this.mAccount=account,this.mContext=context,this.mBookmarkId=0,this.mFolderMap=new Hash,this.mContentUri=null,this.mAuthorityUri=null,this.mBookmarkUri=null,this.bookmarksColumns=[],this.ACCOUNT_SELECTION=`${SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.ACCOUNT_TYPE} == '${SamsungSCloudSyncService.mSyncConstants.ACCOUNT_TYPE}' AND ${SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.ACCOUNT_NAME} == '${SamsungSCloudSyncService.mSyncConstants.ACCOUNT_NAME}'`,this.SBOOKMARK_COLUMNS=[SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.TITLE,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.URL,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.FAVICON,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.PARENT,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.IS_FOLDER,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.POSITION,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.INSERT_AFTER,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.ACCOUNT_NAME,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.ACCOUNT_TYPE,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.SOURCE_ID,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.DEVICE_NAME,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.DEVICE_ID,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.DATE_CREATED,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.DATE_MODIFIED,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.SYNC3,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.SYNC4,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.TAGS,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.DOMINANT_COLOR],this.mBookmarkUri=SamsungSCloudSyncService.mBrowserConstants.BROWSER_BOOKMARK_URI,SamsungSCloudSyncService.BookMarkBuilderGlobal=this,this.parse=function(bookMarkCursor,rowId,key){let bookmarkString=null;if(!bookMarkCursor)return null;try{const values={};bookMarkCursor.TITLE&&(values.title=bookMarkCursor.TITLE.toString()),bookMarkCursor.URL&&(values.url=bookMarkCursor.URL.toString()),bookMarkCursor.FAVICON&&(values.favicon=bookMarkCursor.FAVICON.toString()),bookMarkCursor.ACCOUNT_NAME&&(values.account_name=bookMarkCursor.ACCOUNT_NAME.toString()),bookMarkCursor.ACCOUNT_TYPE&&(values.account_type=bookMarkCursor.ACCOUNT_TYPE.toString()),bookMarkCursor.SOURCEID&&(values.sourceid=bookMarkCursor.SOURCEID.toString()),bookMarkCursor.DEVICE_NAME&&(values.device_name=bookMarkCursor.DEVICE_NAME.toString()),bookMarkCursor.DEVICE_ID&&(values.device_id=bookMarkCursor.DEVICE_ID.toString()),bookMarkCursor.SYNC4&&(values.sync4=bookMarkCursor.SYNC4.toString()),bookMarkCursor.TAGS&&(values.tags=bookMarkCursor.TAGS.toString()),bookMarkCursor.SYNC3?(console.log("sync3",bookMarkCursor.SYNC3),values.sync3=bookMarkCursor.SYNC3.toString()):values.sync3="",bookMarkCursor.PARENT?values.parent=bookMarkCursor.PARENT.toString():values.parent="0",bookMarkCursor.FOLDER?values.folder=bookMarkCursor.FOLDER.toString():values.folder="0",bookMarkCursor.POSITION?values.position=bookMarkCursor.POSITION.toString():values.position="0",bookMarkCursor.INSERT_AFTER?values.insert_after=bookMarkCursor.INSERT_AFTER.toString():values.insert_after="0",bookMarkCursor.CREATED?values.created=bookMarkCursor.CREATED.toString():values.created="0",bookMarkCursor.MODIFIED?values.modified=bookMarkCursor.MODIFIED.toString():values.modified="0",bookMarkCursor.DOMINANT_COLOR?values.dominant_color=bookMarkCursor.DOMINANT_COLOR.toString():values.dominant_color="0",bookmarkString=JSON.stringify(values)}catch(e){SamsungSCloudSyncService.SyncLogs.log(`parse: Exception in parsing${e}`)}return bookmarkString},this.update=function(jsonString,timeStamp,rowId,syncKey,callback){const bookmarkValue=JSON.parse(jsonString);bookmarkValue.position=Number(bookmarkValue.position),bookmarkValue.parent=parseInt(bookmarkValue.parent),delete bookmarkValue.touch_icon;try{const favIcon=bookmarkValue.FAVICON;bookmarkValue.DOMINANT_COLOR;if(null!=favIcon&&"undefined"!=favIcon){let buffer;buffer=btoa(favIcon),bookmarkValue.FAVICON=buffer}bookmarkValue.SYNC2=timeStamp}catch(e){return SamsungSCloudSyncService.SyncLogs.log(`update: Unable to Parse;${e}`),!1}try{this.mProvider.Update(this.mBookmarkUri,bookmarkValue,{equals:[{key:SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS._ID,value:rowId}]},null,callback)}catch(e){return SamsungSCloudSyncService.SyncLogs.log(`update: RemoteException${e}`),!1}return!0},this.insert=function(jsonString,syncKey,timeStamp,cb=null){const bookmarkValue=JSON.parse(jsonString);function defaultIfUndefined(val,def){return""==val||null==val||"undefined"==val||null==val?def:val}delete bookmarkValue.touch_icon;try{var values={title:sanitizeTitle(bookmarkValue.title),url:defaultIfUndefined(bookmarkValue.url,""),favicon:defaultIfUndefined(bookmarkValue.favicon,null),parent:parseInt(bookmarkValue.parent),folder:parseInt(defaultIfUndefined(bookmarkValue.folder,0)),position:parseInt(bookmarkValue.position),insert_after:parseInt(defaultIfUndefined(bookmarkValue.insert_after,0)),account_name:storageLocalApi.getItem("ACCOUNT_NAME"),account_type:bookmarkValue.account_type,sourceid:defaultIfUndefined(bookmarkValue.sourceid,null),device_name:bookmarkValue.device_name,device_id:bookmarkValue.device_id,created:bookmarkValue.created,modified:bookmarkValue.modified,sync3:defaultIfUndefined(bookmarkValue.sync3,null),sync4:bookmarkValue.sync4,tags:defaultIfUndefined(bookmarkValue.tags,null),dominant_color:parseInt(defaultIfUndefined(bookmarkValue.dominant_color,0))};const favIcon=bookmarkValue.favicon;if(null!=favIcon){let buffer;buffer=btoa(favIcon),values.favicon=buffer}values.SYNC1=syncKey,values.SYNC5=timeStamp,bookmarkValue.sync3||(values.parent=this.mBookmarkId)}catch(e){return SamsungSCloudSyncService.SyncLogs.log(`insert: Unable to Parse;${e}`),!1}try{this.mProvider.Insert(this.mBookmarkUri,values,(e=>{cb&&cb(e)}))}catch(e){return SamsungSCloudSyncService.SyncLogs.log(`insert: RemoteException${e}`),!1}return!0},this.getBatchSize=function(){return 1500},this.Delete=function(uri,rowId,selection,syncKey){try{this.mProvider.Delete(uri,selection,null)}catch(e){SamsungSCloudSyncService.SyncLogs.log(`Delete: Exception${e}`)}},this.cleanup=function(){this.mProvider=null,this.mAccount=null,this.mContext=null,this.mBookmarkId=null,this.mFolderMap=null,this.mContentUri=null,this.mAuthorityUri=null,this.mBookmarkUri=null,this.bookmarksColumns=null,this.ACCOUNT_SELECTION=null,this.SBOOKMARK_COLUMNS=null},this.getFolderList=function(){this.mProvider.Query(this.mBookmarkUri,[SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.SYNC4,SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS._ID],{equals:[{key:SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.IS_FOLDER,value:1},{key:SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.ACCOUNT_TYPE,value:SamsungSCloudSyncService.mSyncConstants.ACCOUNT_TYPE},{key:SamsungSCloudSyncService.mBrowserConstants.BOOKMARKS.ACCOUNT_NAME,value:SamsungSCloudSyncService.mSyncConstants.ACCOUNT_NAME}]},null,null,this.getFolderListQueryCallback)},this.getFolderList()}SamsungSCloudSyncService.BookMarkBuilderGlobal=null;