function AuthManager(){this.mClientID=APP_ID,this.mUserId=null,this.mAccessToken=null,this.mRegistrationID=null,this.mBaseUrlPrimary=null,this.mBaseUrlSecondary=null,this.mGetAPIparms=null,this.mPutAPIparms=null,this.mGld_mcc_region=null,this.mGld_user_region=null,this.mGlobalUserId=null,this.INFO_OK=0,this.getGetApiParams=function(cid){SamsungSCloudSyncService.mServerCommonConstants||(SamsungSCloudSyncService.mServerCommonConstants=new ServerCommonConstants);return this.getGetApiParamsWithoutCid()+SamsungSCloudSyncService.mServerCommonConstants.CID_PARM+cid},this.getPutApiParams=function(cid){SamsungSCloudSyncService.mServerCommonConstants||(SamsungSCloudSyncService.mServerCommonConstants=new ServerCommonConstants);return this.getPutAPIParamsWithoutCid()+SamsungSCloudSyncService.mServerCommonConstants.CID_PARM+cid},this.getGetApiParamsWithoutCid=function(){return this.mGetAPIparms=storageLocalApi.getItem("mGetAPIparms"),this.mGetAPIparms},this.getPutAPIParamsWithoutCid=function(){return this.mPutAPIparms=storageLocalApi.getItem("mPutAPIparms"),this.mPutAPIparms},this.getBaseUrl=function(){return this.mBaseUrlPrimary=storageLocalApi.getItem("mBaseUrlPrimary"),this.mBaseUrlPrimary},this.setAccessToken=function(value,isRefresh=!1){if(void 0!==value)return this.mAccessToken=value,this.mUserId=SamsungSCloudSyncService.USER_ID||storageLocalApi.getItem(USER_ID),isRefresh||this.fetchUserInfo(),isFromChina().then((async isChina=>{this.mBaseUrlPrimary=isChina?"cn-api.samsungcloud.com":"api.samsungcloud.com",SamsungSCloudSyncService.mServerCommonConstants=SamsungSCloudSyncService.mServerCommonConstants||new ServerCommonConstants,this.mGetAPIparms=SamsungSCloudSyncService.mServerCommonConstants.USER_ID_PARM+this.mUserId+SamsungSCloudSyncService.mServerCommonConstants.ACCESS_TOKEN_PARM+this.mAccessToken,this.mPutAPIparms=`${this.mGetAPIparms+SamsungSCloudSyncService.mServerCommonConstants.DEVICE_ID_PARM}testdid`,await storageLocalApi.setArrayItems([[PRIMARY_BASE_URL,this.mBaseUrlPrimary],[ACCESS_TOKEN_GET_PARAMS,this.mGetAPIparms],[ACCESS_TOKEN_PUT_PARAMS,this.mPutAPIparms],[IS_LOGGED_OUT,1]]),SamsungSCloudSyncService.BrowserOverlay.onBrowserActionClicked()}));return Promise.reject(`INVALID_TOKEN_VALUE (${value})`)},this.fetchUserInfo=function(){const baseUrl=APIS.ACTIVATE_TOKEN,platform=navigator.platform.replace(/\s/gi,"_"),ipAddress=storageLocalApi.getItem(CLIENT_IP)||"",deviceID=`${platform}_${getBrowserName()}_${EXT_DEVICE_ID}_${ipAddress}`,params=[`uid=${this.mUserId}`,`access_token=${this.mAccessToken}`,`app_id=${APP_ID}`,`device_id=${deviceID}`,"register=true","model=PC-EXTENSION"].join("&").trim(),url=`${baseUrl}?${params}`,headers=new Headers,hash=sha256(`${this.mUserId}:${this.mAccessToken}:${APP_ID}:${deviceID}`);headers.append("Content-Type","application/json"),headers.append("x-sc-hash",hash),SamsungSCloudSyncService.SyncLogs.log("Initiating Activate API"),SamsungSCloudSyncService.SyncLogs.log(JSON.stringify({uid:this.mUserId,access_token:this.mAccessToken,APP_ID:APP_ID,deviceID:deviceID,hash:hash}));const body=JSON.stringify({device_info:{device_os:"9",device_type:"05",device_os_version:"3.0"}});return fetch(url,{headers:headers,method:"POST",body:body}).then((res=>200!==res.status?Promise.reject({error:"Status error",status:res.status}):res.json())).then((res=>0===res.rcode?res:(SamsungSCloudSyncService.SyncLogs.log(JSON.stringify(res,null,2)),Promise.reject({error:"Access token problem",data:{res:res}})))).then((async payload=>{SamsungSCloudSyncService.SyncLogs.log("Authorization successful"),await storageLocalApi.setItem(PUSH_EXPIRE_TIME,payload.push_expire_time)})).catch((payload=>(SamsungSCloudSyncService.SyncLogs.log(`Access token url problem: ${payload.error}`),chrome.runtime.sendMessage({ACCESS_TOKEN_URL_PROBLEM:"NETWORK_ERROR"}),Promise.reject(payload.error))))},this.cleanup=function(){this.mUserId=null,this.mAccessToken=null,this.mRegistrationID=null,this.mBaseUrlPrimary=null,this.mGetAPIparms=null,this.mPutAPIparms=null,this.mBaseUrlSecondary=null}}