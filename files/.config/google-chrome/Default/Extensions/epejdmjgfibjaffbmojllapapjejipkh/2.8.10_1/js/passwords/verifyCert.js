chrome.storage.local.get(["SERVER_CERT"],(function(result){const data=result.SERVER_CERT,pki=forge.pki,rootCert=pki.certificateFromPem(data.rootCert),deviceCert=pki.certificateFromAsn1(forge.asn1.fromDer(forge.util.decode64(data.deviceCert))),serverCert=pki.certificateFromAsn1(forge.asn1.fromDer(forge.util.decode64(data.serverCert)));if(rootCert.verify(serverCert)&&serverCert.verify(deviceCert)){const devicePublicKeyPem=forge.pki.publicKeyToPem(deviceCert.publicKey);chrome.storage.local.set({SPASS_DEVICE_PEM_PUBLIC_KEY:devicePublicKeyPem},(()=>{chrome.runtime.sendMessage({cmd:"VERIFY_SERVER_CERT_SUCCESS",data:{devicePublicKey:deviceCert.publicKey,devicePublicKeyPem:devicePublicKeyPem}})}))}}));